from pathlib import Path
from autoclean import Pipeline

# Define paths - modify these to match your system
EXAMPLE_OUTPUT_DIR = Path("/srv2/RAWDATA/3_From_Collaborators/SPG302-ALS-001/BioTrials/SET_QEEG/Autoclean_output")  # Where processed data will be stored
CONFIG_FILE = Path("configs/autoclean_config_rest_4k.yaml")  # Path to config

# Base directory for resolving relative paths
BASE_DATA_DIR = Path("/srv2/RAWDATA/3_From_Collaborators/SPG302-ALS-001/BioTrials/SET_QEEG/RAW")

# CSV-like data as a string
file_list = """filename,subject,cycle,day,eyes_state,relative_path,full_path
140101_C1D1BL_EO.set,140101,1,1,open,140101_C1D1BL_EO.set,spg302_qeeg/140101_C1D1BL_EO.set
140101_C1D15BL_EO.set,140101,1,15,open,140101_C1D15BL_EO.set,spg302_qeeg/140101_C1D15BL_EO.set
140101_C2D1BL_EO.set,140101,2,1,open,140101_C2D1BL_EO.set,spg302_qeeg/140101_C2D1BL_EO.set
140101_C2D15BL_EO.set,140101,2,15,open,140101_C2D15BL_EO.set,spg302_qeeg/140101_C2D15BL_EO.set
140102_C1D1BL_EO.set,140102,1,1,open,140102_C1D1BL_EO.set,spg302_qeeg/140102_C1D1BL_EO.set
140102_C1D15BL_EO.set,140102,1,15,open,140102_C1D15BL_EO.set,spg302_qeeg/140102_C1D15BL_EO.set
140102_C2D1BL_EO.set,140102,2,1,open,140102_C2D1BL_EO.set,spg302_qeeg/140102_C2D1BL_EO.set
140102_C2D15BL_EO.set,140102,2,15,open,140102_C2D15BL_EO.set,spg302_qeeg/140102_C2D15BL_EO.set
140103_C1D1BL_EO.set,140103,1,1,open,140103_C1D1BL_EO.set,spg302_qeeg/140103_C1D1BL_EO.set
140103_C1D15BL_EO.set,140103,1,15,open,140103_C1D15BL_EO.set,spg302_qeeg/140103_C1D15BL_EO.set
140103_C2D1BL_EO.set,140103,2,1,open,140103_C2D1BL_EO.set,spg302_qeeg/140103_C2D1BL_EO.set
140103_C2D15BL_EO.set,140103,2,15,open,140103_C2D15BL_EO.set,spg302_qeeg/140103_C2D15BL_EO.set
140105_C1D1BL_EO.set,140105,1,1,open,140105_C1D1BL_EO.set,spg302_qeeg/140105_C1D1BL_EO.set
140105_C1D15BL_EO.set,140105,1,15,open,140105_C1D15BL_EO.set,spg302_qeeg/140105_C1D15BL_EO.set
140105_C2D1BL_EO.set,140105,2,1,open,140105_C2D1BL_EO.set,spg302_qeeg/140105_C2D1BL_EO.set
140105_C2D15BL_EO.set,140105,2,15,open,140105_C2D15BL_EO.set,spg302_qeeg/140105_C2D15BL_EO.set
140106_C1D1BL_EO.set,140106,1,1,open,140106_C1D1BL_EO.set,spg302_qeeg/140106_C1D1BL_EO.set
140106_C1D15BL_EO.set,140106,1,15,open,140106_C1D15BL_EO.set,spg302_qeeg/140106_C1D15BL_EO.set
140106_C2D1BL_EO.set,140106,2,1,open,140106_C2D1BL_EO.set,spg302_qeeg/140106_C2D1BL_EO.set
140106_C2D15BL_EO.set,140106,2,15,open,140106_C2D15BL_EO.set,spg302_qeeg/140106_C2D15BL_EO.set
140107_C1D1BL_EO.set,140107,1,1,open,140107_C1D1BL_EO.set,spg302_qeeg/140107_C1D1BL_EO.set
140107_C1D15BL_EO.set,140107,1,15,open,140107_C1D15BL_EO.set,spg302_qeeg/140107_C1D15BL_EO.set
140107_C2D1BL_EO.set,140107,2,1,open,140107_C2D1BL_EO.set,spg302_qeeg/140107_C2D1BL_EO.set
140107_C2D15BL_EO.set,140107,2,15,open,140107_C2D15BL_EO.set,spg302_qeeg/140107_C2D15BL_EO.set
140108_C1D1BL_EO.set,140108,1,1,open,140108_C1D1BL_EO.set,spg302_qeeg/140108_C1D1BL_EO.set
140108_C1D15BL_EO.set,140108,1,15,open,140108_C1D15BL_EO.set,spg302_qeeg/140108_C1D15BL_EO.set
140108_C2D1BL_EO.set,140108,2,1,open,140108_C2D1BL_EO.set,spg302_qeeg/140108_C2D1BL_EO.set
140108_C2D15BL_EO.set,140108,2,15,open,140108_C2D15BL_EO.set,spg302_qeeg/140108_C2D15BL_EO.set
150101_C1D1BL_EO.set,150101,1,1,open,150101_C1D1BL_EO.set,spg302_qeeg/150101_C1D1BL_EO.set
150101_C1D15BL_EO.set,150101,1,15,open,150101_C1D15BL_EO.set,spg302_qeeg/150101_C1D15BL_EO.set
150101_C2D1BL_EO.set,150101,2,1,open,150101_C2D1BL_EO.set,spg302_qeeg/150101_C2D1BL_EO.set
150101_C2D15BL_EO.set,150101,2,15,open,150101_C2D15BL_EO.set,spg302_qeeg/150101_C2D15BL_EO.set
150103_C1D1BL_EO.set,150103,1,1,open,150103_C1D1BL_EO.set,spg302_qeeg/150103_C1D1BL_EO.set
150103_C1D15BL_EO.set,150103,1,15,open,150103_C1D15BL_EO.set,spg302_qeeg/150103_C1D15BL_EO.set
150103_C2D1BL_EO.set,150103,2,1,open,150103_C2D1BL_EO.set,spg302_qeeg/150103_C2D1BL_EO.set
150103_C2D15BL_EO.set,150103,2,15,open,150103_C2D15BL_EO.set,spg302_qeeg/150103_C2D15BL_EO.set
150104_C1D1BL_EO.set,150104,1,1,open,150104_C1D1BL_EO.set,spg302_qeeg/150104_C1D1BL_EO.set
150104_C1D15BL_EO.set,150104,1,15,open,150104_C1D15BL_EO.set,spg302_qeeg/150104_C1D15BL_EO.set
150104_C2D1BL_EO.set,150104,2,1,open,150104_C2D1BL_EO.set,spg302_qeeg/150104_C2D1BL_EO.set
150104_C2D15BL_EO.set,150104,2,15,open,150104_C2D15BL_EO.set,spg302_qeeg/150104_C2D15BL_EO.set
150105_C1D1BL_EO.set,150105,1,1,open,150105_C1D1BL_EO.set,spg302_qeeg/150105_C1D1BL_EO.set
150105_C1D15BL_EO.set,150105,1,15,open,150105_C1D15BL_EO.set,spg302_qeeg/150105_C1D15BL_EO.set
150105_C2D1BL_EO.set,150105,2,1,open,150105_C2D1BL_EO.set,spg302_qeeg/150105_C2D1BL_EO.set
150105_C2D15BL_EO.set,150105,2,15,open,150105_C2D15BL_EO.set,spg302_qeeg/150105_C2D15BL_EO.set
150106_C1D1BL_EO.set,150106,1,1,open,150106_C1D1BL_EO.set,spg302_qeeg/150106_C1D1BL_EO.set
150106_C1D15BL_EO.set,150106,1,15,open,150106_C1D15BL_EO.set,spg302_qeeg/150106_C1D15BL_EO.set
150106_C2D1BL_EO.set,150106,2,1,open,150106_C2D1BL_EO.set,spg302_qeeg/150106_C2D1BL_EO.set
150106_C2D15BL_EO.set,150106,2,15,open,150106_C2D15BL_EO.set,spg302_qeeg/150106_C2D15BL_EO.set
150107_C1D1BL_EO.set,150107,1,1,open,150107_C1D1BL_EO.set,spg302_qeeg/150107_C1D1BL_EO.set
150107_C1D15BL_EO.set,150107,1,15,open,150107_C1D15BL_EO.set,spg302_qeeg/150107_C1D15BL_EO.set
150107_C2D1BL_EO.set,150107,2,1,open,150107_C2D1BL_EO.set,spg302_qeeg/150107_C2D1BL_EO.set
150107_C2D15BL_EO.set,150107,2,15,open,150107_C2D15BL_EO.set,spg302_qeeg/150107_C2D15BL_EO.set
150108_C1D1BL_EO.set,150108,1,1,open,150108_C1D1BL_EO.set,spg302_qeeg/150108_C1D1BL_EO.set
150108_C1D15BL_EO.set,150108,1,15,open,150108_C1D15BL_EO.set,spg302_qeeg/150108_C1D15BL_EO.set
150108_C2D1BL_EO.set,150108,2,1,open,150108_C2D1BL_EO.set,spg302_qeeg/150108_C2D1BL_EO.set
150108_C2D15BL_EO.set,150108,2,15,open,150108_C2D15BL_EO.set,spg302_qeeg/150108_C2D15BL_EO.set
150109_C1D1BL_EO.set,150109,1,1,open,150109_C1D1BL_EO.set,spg302_qeeg/150109_C1D1BL_EO.set
150109_C1D15BL_EO.set,150109,1,15,open,150109_C1D15BL_EO.set,spg302_qeeg/150109_C1D15BL_EO.set
150109_C2D1BL_EO.set,150109,2,1,open,150109_C2D1BL_EO.set,spg302_qeeg/150109_C2D1BL_EO.set
150109_C2D15BL_EO.set,150109,2,15,open,150109_C2D15BL_EO.set,spg302_qeeg/150109_C2D15BL_EO.set
150111_C1D1BL_EO.set,150111,1,1,open,150111_C1D1BL_EO.set,spg302_qeeg/150111_C1D1BL_EO.set
150111_C1D15BL_EO.set,150111,1,15,open,150111_C1D15BL_EO.set,spg302_qeeg/150111_C1D15BL_EO.set
150111_C2D1BL_EO.set,150111,2,1,open,150111_C2D1BL_EO.set,spg302_qeeg/150111_C2D1BL_EO.set
150111_C2D15BL_EO.set,150111,2,15,open,150111_C2D15BL_EO.set,spg302_qeeg/150111_C2D15BL_EO.set
150112_C1D1BL_EO.set,150112,1,1,open,150112_C1D1BL_EO.set,spg302_qeeg/150112_C1D1BL_EO.set
150112_C1D15BL_EO.set,150112,1,15,open,150112_C1D15BL_EO.set,spg302_qeeg/150112_C1D15BL_EO.set
150112_C2D1BL_EO.set,150112,2,1,open,150112_C2D1BL_EO.set,spg302_qeeg/150112_C2D1BL_EO.set
150112_C2D15BL_EO.set,150112,2,15,open,150112_C2D15BL_EO.set,spg302_qeeg/150112_C2D15BL_EO.set
170101_C1D1BL_EO.set,170101,1,1,open,170101_C1D1BL_EO.set,spg302_qeeg/170101_C1D1BL_EO.set
170101_C1D15BL_EO.set,170101,1,15,open,170101_C1D15BL_EO.set,spg302_qeeg/170101_C1D15BL_EO.set
170101_C2D1BL_EO.set,170101,2,1,open,170101_C2D1BL_EO.set,spg302_qeeg/170101_C2D1BL_EO.set
170101_C2D15BL_EO.set,170101,2,15,open,170101_C2D15BL_EO.set,spg302_qeeg/170101_C2D15BL_EO.set
170102_C1D1BL_EO.set,170102,1,1,open,170102_C1D1BL_EO.set,spg302_qeeg/170102_C1D1BL_EO.set
170102_C1D15BL_EO.set,170102,1,15,open,170102_C1D15BL_EO.set,spg302_qeeg/170102_C1D15BL_EO.set
170102_C2D1BL_EO.set,170102,2,1,open,170102_C2D1BL_EO.set,spg302_qeeg/170102_C2D1BL_EO.set
170102_C2D15BL_EO.set,170102,2,15,open,170102_C2D15BL_EO.set,spg302_qeeg/170102_C2D15BL_EO.set
170103_C1D1BL_EO.set,170103,1,1,open,170103_C1D1BL_EO.set,spg302_qeeg/170103_C1D1BL_EO.set
170103_C1D15BL_EO.set,170103,1,15,open,170103_C1D15BL_EO.set,spg302_qeeg/170103_C1D15BL_EO.set
170103_C2D1BL_EO.set,170103,2,1,open,170103_C2D1BL_EO.set,spg302_qeeg/170103_C2D1BL_EO.set
170103_C2D15BL_EO.set,170103,2,15,open,170103_C2D15BL_EO.set,spg302_qeeg/170103_C2D15BL_EO.set
170104_C1D1BL_EO.set,170104,1,1,open,170104_C1D1BL_EO.set,spg302_qeeg/170104_C1D1BL_EO.set
170104_C1D15BL_EO.set,170104,1,15,open,170104_C1D15BL_EO.set,spg302_qeeg/170104_C1D15BL_EO.set
170104_C2D1BL_EO.set,170104,2,1,open,170104_C2D1BL_EO.set,spg302_qeeg/170104_C2D1BL_EO.set
170104_C2D15BL_EO.set,170104,2,15,open,170104_C2D15BL_EO.set,spg302_qeeg/170104_C2D15BL_EO.set
170105_C1D1BL_EO.set,170105,1,1,open,170105_C1D1BL_EO.set,spg302_qeeg/170105_C1D1BL_EO.set
170105_C1D15BL_EO.set,170105,1,15,open,170105_C1D15BL_EO.set,spg302_qeeg/170105_C1D15BL_EO.set
170105_C2D1BL_EO.set,170105,2,1,open,170105_C2D1BL_EO.set,spg302_qeeg/170105_C2D1BL_EO.set
170105_C2D15BL_EO.set,170105,2,15,open,170105_C2D15BL_EO.set,spg302_qeeg/170105_C2D15BL_EO.set
170106_C1D1BL_EO.set,170106,1,1,open,170106_C1D1BL_EO.set,spg302_qeeg/170106_C1D1BL_EO.set
170106_C1D15BL_EO.set,170106,1,15,open,170106_C1D15BL_EO.set,spg302_qeeg/170106_C1D15BL_EO.set
170106_C2D1BL_EO.set,170106,2,1,open,170106_C2D1BL_EO.set,spg302_qeeg/170106_C2D1BL_EO.set
170106_C2D15BL_EO.set,170106,2,15,open,170106_C2D15BL_EO.set,spg302_qeeg/170106_C2D15BL_EO.set
170107_C1D1BL_EO.set,170107,1,1,open,170107_C1D1BL_EO.set,spg302_qeeg/170107_C1D1BL_EO.set
170107_C1D15BL_EO.set,170107,1,15,open,170107_C1D15BL_EO.set,spg302_qeeg/170107_C1D15BL_EO.set
170107_C2D1BL_EO.set,170107,2,1,open,170107_C2D1BL_EO.set,spg302_qeeg/170107_C2D1BL_EO.set
170107_C2D15BL_EO.set,170107,2,15,open,170107_C2D15BL_EO.set,spg302_qeeg/170107_C2D15BL_EO.set"""

# Create pipeline instance
pipeline = Pipeline(
    autoclean_dir=EXAMPLE_OUTPUT_DIR,
    autoclean_config=CONFIG_FILE,
    verbose='INFO'  # Set to 'DEBUG' for more detailed logging
)

# Parse the file list manually
lines = file_list.strip().split('\n')
header = lines[0].split(',')
data = [line.split(',') for line in lines[1:]]

# Process each file
for row in data:
    filename, subject, cycle, day, eyes_state, relative_path, full_path = row
    # Resolve the full path
    full_path = BASE_DATA_DIR / full_path
    
    print(f"Processing file: {full_path}")
    try:
        pipeline.process_file(
            file_path=full_path,
            task="resting_eyesopen_grael4k"  # Adjust task name as needed
        )
        print(f"Successfully processed: {full_path}")
    except Exception as e:
        print(f"Error processing {full_path}: {str(e)}")

